<!doctype html>
<html
  dir="ltr"
  lang="en"
  data-theme="dark"
  
    class="html theme--dark"
  
><head>
  <meta charset="utf-8" />
  <title>
    Matt Broberg
        |
        Introduction to ad hoc telemetry with Snap and Grafana
      

    

  </title>

  <meta name="generator" content="Hugo 0.144.1"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="author" content="Matt Broberg" />
  <meta
    name="description"
    content="Product Thinking | Systems Builder |
 Open Source Advocate | People Leader"
  />
  
  
    
    
    <link
      rel="stylesheet"
      href="/scss/main.min.36cc347f9ef17e6277665cea4826f9446016e7a324f22a9b3679ba8895381662.css"
      integrity="sha256-Nsw0f57xfmJ3ZlzqSCb5RGAW56Mk8iqbNnm6iJU4FmI="
      crossorigin="anonymous"
      type="text/css"
    />
  

  
  <link
    rel="stylesheet"
    href="/css/markupHighlight.min.73ccfdf28df555e11009c13c20ced067af3cb021504cba43644c705930428b00.css"
    integrity="sha256-c8z98o31VeEQCcE8IM7QZ688sCFQTLpDZExwWTBCiwA="
    crossorigin="anonymous"
    type="text/css"
  />
  
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/fontawesome.min.137b1cf3cea9a8adb7884343a9a5ddddf4280f59153f74dc782fb7f7bf0d0519.css"
    integrity="sha256-E3sc886pqK23iENDqaXd3fQoD1kVP3TceC&#43;3978NBRk="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/solid.min.e65dc5b48fb5f39b142360c57c3a215744c94e56c755c929cc3e88fe12aab4d3.css"
    integrity="sha256-5l3FtI&#43;185sUI2DFfDohV0TJTlbHVckpzD6I/hKqtNM="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/regular.min.6f4f16d58da1c82c0c3a3436e021a3d39b4742f741192c546e73e947eacfd92f.css"
    integrity="sha256-b08W1Y2hyCwMOjQ24CGj05tHQvdBGSxUbnPpR&#43;rP2S8="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/brands.min.e10425ad768bc98ff1fb272a0ac8420f9d1ba22f0612c08ff1010c95080ffe7e.css"
    integrity="sha256-4QQlrXaLyY/x&#43;ycqCshCD50boi8GEsCP8QEMlQgP/n4="
    crossorigin="anonymous"
    type="text/css"
  />
  
    
    
    
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Outfit&amp;display=swap" rel="stylesheet" />
  <link rel="shortcut icon" href="/favicons/favicon.ico" type="image/x-icon" />
  <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png" />

  <link rel="canonical" href="https://mbbroberg.fun/intro-to-ad-hoc-telemetry-snap-grafana/" />

  
  
  
  
  <script
    type="text/javascript"
    src="/js/anatole-header.min.f9132794301a01ff16550ed66763482bd848f62243d278f5e550229a158bfd32.js"
    integrity="sha256-&#43;RMnlDAaAf8WVQ7WZ2NIK9hI9iJD0nj15VAimhWL/TI="
    crossorigin="anonymous"
  ></script>

  
    
    
    <script
      type="text/javascript"
      src="/js/anatole-theme-switcher.min.d6d329d93844b162e8bed1e915619625ca91687952177552b9b3e211014a2957.js"
      integrity="sha256-1tMp2ThEsWLovtHpFWGWJcqRaHlSF3VSubPiEQFKKVc="
      crossorigin="anonymous"
    ></script>
  

  

  


  
  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Introduction to ad hoc telemetry with Snap and Grafana">
  <meta name="twitter:description" content="What makes Snap different?
That‚Äôs the right question to ask and one I answered hundreds of times in the last couple weeks. It began at O‚ÄôReilly Velocity as Ops-minded teams were curious about the introduction of Snap to the Open Source toolkit. The conversations continue this week at (my first) Monitorama, which is the most amazing Operations-centric conference I‚Äôve ever attended. There are a lot of familiar faces across the two and for good reason: people want to understand the how and why of data center operations.">



  
  <meta property="og:url" content="https://mbbroberg.fun/intro-to-ad-hoc-telemetry-snap-grafana/">
  <meta property="og:site_name" content="Matthew Broberg">
  <meta property="og:title" content="Introduction to ad hoc telemetry with Snap and Grafana">
  <meta property="og:description" content="What makes Snap different?
That‚Äôs the right question to ask and one I answered hundreds of times in the last couple weeks. It began at O‚ÄôReilly Velocity as Ops-minded teams were curious about the introduction of Snap to the Open Source toolkit. The conversations continue this week at (my first) Monitorama, which is the most amazing Operations-centric conference I‚Äôve ever attended. There are a lot of familiar faces across the two and for good reason: people want to understand the how and why of data center operations.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="articles">
    <meta property="article:published_time" content="2016-07-01T00:00:00+00:00">
    <meta property="article:modified_time" content="2016-07-01T00:00:00+00:00">



  
  
  
  
  <script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "articleSection": "articles",
        "name": "Introduction to ad hoc telemetry with Snap and Grafana",
        "headline": "Introduction to ad hoc telemetry with Snap and Grafana",
        "alternativeHeadline": "",
        "description": "
      
        \u003cp\u003e\u003cem\u003eWhat makes Snap different?\u003c\/em\u003e\u003c\/p\u003e\n\u003cp\u003eThat‚Äôs the right question to ask and one I answered hundreds of times in the last couple weeks. It began at O‚ÄôReilly Velocity as Ops-minded teams were curious about the introduction of Snap to the Open Source toolkit. The conversations continue this week at (my first) \u003ca href=\u0022http:\/\/monitorama.com\u0022\u003eMonitorama\u003c\/a\u003e, which is the most amazing Operations-centric conference I‚Äôve ever attended. There are a lot of familiar faces across the two and for good reason: people want to understand the how and why of data center operations.\u003c\/p\u003e


      


    ",
        "inLanguage": "en",
        "isFamilyFriendly": "true",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/mbbroberg.fun\/intro-to-ad-hoc-telemetry-snap-grafana\/"
        },
        "author" : {
            "@type": "Person",
            "name": "Matt Broberg"
        },
        "creator" : {
            "@type": "Person",
            "name": "Matt Broberg"
        },
        "accountablePerson" : {
            "@type": "Person",
            "name": "Matt Broberg"
        },
        "copyrightHolder" : {
            "@type": "Person",
            "name": "Matt Broberg"
        },
        "copyrightYear" : "2016",
        "dateCreated": "2016-07-01T00:00:00.00Z",
        "datePublished": "2016-07-01T00:00:00.00Z",
        "dateModified": "2016-07-01T00:00:00.00Z",
        "publisher":{
            "@type":"Organization",
            "name": "Matt Broberg",
            "url": "https://mbbroberg.fun/",
            "logo": {
                "@type": "ImageObject",
                "url": "https:\/\/mbbroberg.fun\/favicons\/favicon-32x32.png",
                "width":"32",
                "height":"32"
            }
        },
        "image": 
      [
      ]

    ,
        "url" : "https:\/\/mbbroberg.fun\/intro-to-ad-hoc-telemetry-snap-grafana\/",
        "wordCount" : "812",
        "genre" : [ ],
        "keywords" : [ ]
    }
  </script>


</head>
<body class="body">
    <div class="wrapper">
      <aside
        
          class="wrapper__sidebar"
        
      ><div
  class="sidebar
    animated fadeInDown
  "
>
  <div class="sidebar__content">
    <div class="sidebar__introduction">
      <img
        class="sidebar__introduction-profileimage"
        src="/images/profile.jpg"
        alt="profile picture"
      />
      
        <div class="sidebar__introduction-title">
          <a href="/">Matthew Broberg</a>
        </div>
      
      <div class="sidebar__introduction-description">
        <p>Product Thinking | Systems Builder |<br /> Open Source Advocate | People Leader</p>
      </div>
    </div>
    <ul class="sidebar__list">
      
        <li class="sidebar__list-item">
          <a
            href="https://floss.social/@mbbroberg"
            target="_blank"
            rel="noopener me"
            aria-label="Mastodon"
            title="Mastodon"
          >
            <i class="fab fa-mastodon fa-2x" aria-hidden="true"></i>
          </a>
        </li>
      
        <li class="sidebar__list-item">
          <a
            href="https://linkedin.com/in/mbbroberg/"
            target="_blank"
            rel="noopener me"
            aria-label="Linkedin"
            title="Linkedin"
          >
            <i class="fab fa-linkedin fa-2x" aria-hidden="true"></i>
          </a>
        </li>
      
        <li class="sidebar__list-item">
          <a
            href="https://bsky.app/profile/mbbroberg.fun"
            target="_blank"
            rel="noopener me"
            aria-label="Bluesky"
            title="Bluesky"
          >
            <i class="fab fa-bluesky fa-2x" aria-hidden="true"></i>
          </a>
        </li>
      
        <li class="sidebar__list-item">
          <a
            href="https://github.com/mbbroberg/"
            target="_blank"
            rel="noopener me"
            aria-label="GitHub"
            title="GitHub"
          >
            <i class="fab fa-github fa-2x" aria-hidden="true"></i>
          </a>
        </li>
      
        <li class="sidebar__list-item">
          <a
            href="mailto:matthewbbroberg&#43;io@gmail.com"
            target="_blank"
            rel="noopener me"
            aria-label="e-mail"
            title="e-mail"
          >
            <i class="fas fa-envelope fa-2x" aria-hidden="true"></i>
          </a>
        </li>
      
    </ul>
  </div><footer class="footer footer__sidebar">
  <ul class="footer__list">
    <li class="footer__item">
      &copy;
      
        Matt Broberg
        2025
      
    </li>
    
  </ul>
</footer>
  
  <script
    type="text/javascript"
    src="/js/medium-zoom.min.1248fa75275e5ef0cbef27e8c1e27dc507c445ae3a2c7d2ed0be0809555dac64.js"
    integrity="sha256-Ekj6dSdeXvDL7yfoweJ9xQfERa46LH0u0L4ICVVdrGQ="
    crossorigin="anonymous"
  ></script></div>
</aside>
      <main
        
          class="wrapper__main"
        
      >
        <header class="header"><div
  class="
    animated fadeInDown
  "
>
  <a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false">
    <span aria-hidden="true" class="navbar-burger__line"></span>
    <span aria-hidden="true" class="navbar-burger__line"></span>
    <span aria-hidden="true" class="navbar-burger__line"></span>
  </a>
  <nav class="nav">
    <ul class="nav__list" id="navMenu">
      
      
        
        
          <li class="nav__list-item">
            
            <a
              
              href="/"
              
              title=""
              >üè°</a
            >
          </li>
        

      
        
        
          <li class="nav__list-item">
            
            <a
              
              href="/articles/"
              
              title=""
              >Articles üí°</a
            >
          </li>
        

      
        
        
          <li class="nav__list-item">
            
            <a
              
              href="/garden/"
              
              title=""
              >Digital Garden üå±</a
            >
          </li>
        

      
        
        
          <li class="nav__list-item">
            
            <a
              
              href="/podcasts/"
              
              title=""
              >Podcasts üéôÔ∏è</a
            >
          </li>
        

      
        
        
          <li class="nav__list-item">
            
            <a
              
              href="/talks/"
              
              title=""
              >Talks üì£</a
            >
          </li>
        

      
    </ul>
    <ul class="nav__list nav__list--end">
      
      
        <li class="nav__list-item">
          <div class="themeswitch">
            <a title="Switch Theme">
              <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a>
          </div>
        </li>
      
    </ul>
  </nav>
</div>
</header>
  <div
    class="post 
      animated fadeInDown
    "
  >
    
    <div class="post__content">
      
        <h1>Introduction to Ad Hoc Telemetry With Snap and Grafana</h1>
      
      <p><em>What makes Snap different?</em></p>
<p>That‚Äôs the right question to ask and one I answered hundreds of times in the last couple weeks. It began at O‚ÄôReilly Velocity as Ops-minded teams were curious about the introduction of Snap to the Open Source toolkit. The conversations continue this week at (my first) <a href="http://monitorama.com">Monitorama</a>, which is the most amazing Operations-centric conference I‚Äôve ever attended. There are a lot of familiar faces across the two and for good reason: people want to understand the how and why of data center operations.</p>
<p>But to the question at hand: <strong>why Snap</strong> vs this or that?</p>
<p><img src="/img/1*MaYIUQGtqyU1cdTut7BuDA.jpeg" alt="">Me making hand motions while I demo Snap at Velocity Conf 2016.<strong>It‚Äôs about the API.</strong> The design of Snap allows for the collection, processing and publishing of telemetry AND the administration of it to be managed. And that makes all the difference.</p>
<p><em>‚ÄúGive me a for instance.‚Äù</em></p>
<p>Okay, let‚Äôs get concrete. You have a site outage. Your monitoring shows that you have an issue with your database, but your day-to-day view of the problem is at a lower granularity than you need to find the culprit. That‚Äôs common ‚Äî most people monitor at a 1 to 5 minute fidelity, but like to get down to 1 *second or less *during an issue. How do you add this greater visibility into the database? Well, you usually need to setup an entirely new telemetry system to even see the same stats at a greater granularity (let alone *new *metrics). That means installing software on servers that are in production and having issues as we speak. Alternatively, with Snap, we can stream stats directly to Grafana.</p>
<p><img src="/img/1*ilxjE2d2iOAqqOU_pEhtjg.png" alt="">#### Configuring my environment for *ad hoc *queries</p>
<p>Let‚Äôs set something up and take a look around. We need Grafana and Snap running at a minimum, so here is the quick way to see the power of the API.</p>
<p>I‚Äôve covered how to get Snap running in a few different ways, so I‚Äôll skipping repeating it here. If you‚Äôd like to take this part step-by-step, <a href="https://medium.com/intel-sdi/my-how-to-for-the-snap-telemetry-framework-e3bb641bc740#.vgodp7djb">see this tutorial</a>. If you want to take the source code route, <a href="https://medium.com/intel-sdi/setting-up-your-snap-development-environment-ab010e861cab#.a13ejl65l">run through this refresher</a> on environment configuration for Go development. You can also follow practices outlined under <a href="https://github.com/intelsdi-x/snap#running-snap">Running Snap</a> to install <em>snapd</em> and load the psutil plugin that way. With all those options outlined, we‚Äôll move on.</p>
<p>With Snap installed, we can start the daemon and load a collector. This time we‚Äôll use the psutil plugin:</p>
<p>$ cd ~/Desktop/snap-v0.14.0-beta/bin<br>
$ ./snapd -t 0 &amp;<br>
$ ./snapctl plugin load ../plugin/snap-plugin-collector-psutil<strong>Disclaimer</strong>: these paths are relative, so be sure to point to wherever you put <em>snapd</em> and the plugin.</p>
<p>Snap is running and loaded with the only plugin in we need for this example. Let‚Äôs get Grafana up locally. If you‚Äôre comfortable with Go development, you can build from source:</p>
<p>$ go get github.com/grafana/grafanaOr if you have the good fortune to be on OS X, use <a href="http://docs.grafana.org/installation/mac/">homebrew</a>:</p>
<p>brew install grafana/grafana/grafanaGrafana has an app model to extend its functionality. We need the Snap App (<a href="https://github.com/raintank/snap-app">source</a>), which is easily installed on the command-line:</p>
<p>$ grafana-cli &ndash;pluginsDir=‚Äù/usr/local/var/lib/grafana‚Äù plugins install raintank-snap-appinstalling raintank-snap-app @ 0.0.3<br>
from url: <a href="https://grafana.net/api/plugins/raintank-snap-app/versions/0.0.3/download">https://grafana.net/api/plugins/raintank-snap-app/versions/0.0.3/download</a><br>
into: /usr/local/var/lib/grafana‚úî Installed raintank-snap-app successfullyRestart grafana after installing plugins . <service grafana-server restart>Now we can start Grafana and point to the app along with our other default configuration requirements:</p>
<p>$ grafana-server &ndash;config=/usr/local/etc/grafana/grafana.ini &ndash;homepath /usr/local/share/grafana cfg:default.paths.logs=/usr/local/var/log/grafana cfg:default.paths.data=/usr/local/var/lib/grafana cfg:default.paths.plugins=/usr/local/var/lib/grafanaAnd we see from the output that it installs the app and is up and running:</p>
<p>2016/06/28 10:32:47 [I] Starting Grafana&hellip; truncated &hellip; 2016/06/28 10:32:47 [I] Plugins: Adding route /public/plugins/raintank-snap-datasource -&gt; /usr/local/var/lib/grafana/raintank-snap-app/dist/datasource<br>
2016/06/28 10:32:47 [I] Plugins: Adding route /public/plugins/raintank-snap-app -&gt; /usr/local/var/lib/grafana/raintank-snap-app/dist<br>
2016/06/28 10:32:47 [I] Listen: <a href="http://0.0.0.0:3000">http://0.0.0.0:3000</a>Now we can <a href="http://127.0.0.1:3000">login to Grafana at port 3000</a>. From there:</p>
<ol>
<li>Click the top-left icon and open Plugins</li>
<li>Click the Apps tab, open Snap App, Enable it</li>
<li>From the top-left icon again, go to Data Sources</li>
<li>Add a new data source of type Snap DS pointing to your <em>snapd</em> instance (including port, which is 8181 by default)</li>
<li>Start a new Dashboard with a Graph panel, select Snap DS as the data source</li>
<li>Create the task! Name it, choose an interval and metrics, then start it</li>
<li>Click watch to see live data stream from Snap to the graph just like you would using <em>snapctl task watch</em>
<img src="/img/1*sXlgFQpongx-8cn-6TPWwg.png" alt="">By taking these steps, you configured a Task in Snap all through the API.</li>
</ol>
<p>I‚Äôve already wrote about how <a href="https://medium.com/intel-sdi/the-guts-of-tasks-how-snap-runs-8c5d2405ea61#.y8jibkpg3">Tasks are a powerful abstraction</a> for telemetry, but they take on a life of their own once you bring them to a GUI like Grafana.</p>
<h4 id="what-will-you-measure-next">What will you measure next?</h4>
<p>Telemetry is exciting when you have the right data in the right format and sent to the right places. I would love to see more examples of what you measure for day-to-day Ops. If there isn‚Äôt a collector for it in the <a href="https://github.com/intelsdi-x/snap/blob/master/docs/PLUGIN_CATALOG.md">Plugin Catalog</a>, I would love to see you <a href="https://github.com/intelsdi-x/snap/blob/master/docs/PLUGIN_AUTHORING.md">build your own</a>!</p>
<p><em>This article was originally published <a href="https://medium.com/@mbbroberg">on Medium</a></em></p>


  <h3>Related Posts</h3>
  <ul>
    
      <li><a href="/make-obsidian-inline-dataview-properties-prettier-with-this-css/">Make Obsidian inline dataview properties prettier with this CSS</a></li>
    
      <li><a href="/my-path-to-personal-knowledge-management-pkm/">My path to Personal Knowledge Management (PKM)</a></li>
    
      <li><a href="/literate-programming-def/">Literate Programming (def)</a></li>
    
  </ul>

</div>
    <div class="post__footer">
      

      
    </div>

    
  </div>

      </main>
    </div><footer class="footer footer__base">
  <ul class="footer__list">
    <li class="footer__item">
      &copy;
      
        Matt Broberg
        2025
      
    </li>
    
  </ul>
</footer>
  
  <script
    type="text/javascript"
    src="/js/medium-zoom.min.1248fa75275e5ef0cbef27e8c1e27dc507c445ae3a2c7d2ed0be0809555dac64.js"
    integrity="sha256-Ekj6dSdeXvDL7yfoweJ9xQfERa46LH0u0L4ICVVdrGQ="
    crossorigin="anonymous"
  ></script></body>
</html>
